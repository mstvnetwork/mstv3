<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
  <title>MSTV Live - Sequential Playlist</title>
  <style>
    /* ... keep your existing styling here from before ... */
    /* For brevity, only essential styles shown here */
    body {
      margin: 0; background: #000; color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align:center;
    }
    .title {
      font-size: 2.5rem; font-weight: 900; color: gold; margin: 1rem 0 0; text-shadow: 0 0 15px gold;
    }
    .player-container {
      width: 90%; max-width: 720px; margin: 1rem auto; aspect-ratio: 16 / 9; position: relative; background: #111;
      border: 3px solid gold; border-radius: 16px; overflow: hidden; user-select: none; touch-action: none;
    }
    video, #ytPlayer {
      width: 100%; height: 100%; pointer-events: none; user-select: none; touch-action: none;
    }
    #ytPlayer { display: none; }
    #speakerBtn {
      position: absolute; bottom: 12px; right: 12px; background: rgba(255, 215, 0, 0.8);
      border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;
      cursor: pointer; z-index: 20; box-shadow: 0 0 8px gold; transition: background-color 0.3s ease;
    }
    #speakerBtn:hover { background: rgba(255, 215, 0, 1); }
    #speakerIcon { width: 24px; height: 24px; fill: #000; }
    #muteCross { stroke: #000; stroke-width: 2; stroke-linecap: round; display:none; }
    .now-playing {
      margin-top: 0.5rem; font-size: 1.2rem; font-weight: 600; text-shadow: 0 0 3px #000;
    }
    .tv-guide {
      width: 90%; max-width: 720px; margin: 1rem auto 3rem; background: linear-gradient(90deg, #222, #111);
      border-radius: 12px; box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); padding: 16px 24px; user-select: none;
      font-family: 'Consolas', monospace;
    }
    .tv-guide h2 {
      margin-bottom: 12px; font-weight: 800; color: gold; text-shadow: 0 0 8px orange; font-size: 1.5rem; letter-spacing: 1.5px;
    }
    #tvGuideList {
      list-style: none; padding: 0; margin: 0; max-height: 300px; overflow-y: auto;
      scrollbar-width: thin; scrollbar-color: gold transparent;
    }
    #tvGuideList::-webkit-scrollbar {
      width: 6px;
    }
    #tvGuideList::-webkit-scrollbar-thumb {
      background-color: gold; border-radius: 3px;
    }
    #tvGuideList li {
      padding: 10px 16px; margin-bottom: 6px; border-radius: 8px; background: #222;
      font-weight: 600; font-size: 1.1rem; color: #eee; cursor: default;
      display: flex; justify-content: space-between; align-items: center;
      transition: background-color 0.25s ease;
    }
    #tvGuideList li.active {
      background: gold; color: #000; font-weight: 800; box-shadow: 0 0 15px gold;
      pointer-events: none;
    }
    #tvGuideList li span.title {
      flex-grow: 1; text-align: left; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    footer {
      margin: 2rem 0 3rem; font-size: 0.8rem; color: #aaa; user-select: none;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>

  <h1 class="title">MSTV NETWORK</h1>
  <marquee class="golden-scroll" behavior="scroll" direction="left" scrollamount="7" scrolldelay="80">
    ðŸ”¥ Welcome to MSTV | Live Streaming | Entertainment | News | Music ðŸ”¥
  </marquee>

  <div class="now-playing" id="nowPlaying">Now Playing: Loading...</div>

  <div class="player-container" id="playerContainer">
    <video id="hlsPlayer" muted autoplay playsinline style="display:none;" controlsList="nodownload nofullscreen noremoteplayback"></video>
    <div id="ytPlayer"></div>

    <div id="speakerBtn" title="Toggle mute">
      <svg id="speakerIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M5 9v6h4l5 5V4L9 9H5z"/>
        <path id="muteCross" d="M16 8l4 4m0-4l-4 4" stroke="#000" stroke-width="2" stroke-linecap="round" style="display:none"/>
      </svg>
    </div>
  </div>

  <section class="tv-guide">
    <h2>ðŸ“º Playlist Guide</h2>
    <ul id="tvGuideList" tabindex="0" aria-label="Playlist Guide"></ul>
  </section>

  <footer>
    Â© 2025 MSTV Network. All rights reserved.
  </footer>

  <script>
    const hlsPlayer = document.getElementById('hlsPlayer');
    const ytContainer = document.getElementById('ytPlayer');
    const nowPlaying = document.getElementById('nowPlaying');
    const tvGuideList = document.getElementById('tvGuideList');
    const speakerBtn = document.getElementById('speakerBtn');
    const muteCross = document.getElementById('muteCross');

    const sources = [
      { title: "Bollywood Hits 1", url: "https://www.youtube.com/watch?v=NdYQ00MM-IY", type: "youtube" },
      { title: "Bollywood Hits 2", url: "https://www.youtube.com/watch?v=_ZXk0hu5BLA", type: "youtube" },
      { title: "Live News", url: "https://www.youtube.com/watch?v=1b8bBvoIFHY", type: "youtube" }
    ];

    let currentIndex = 0;
    let ytPlayer = null;
    let isMuted = true;

    // Initialize player UI
    function updateNowPlaying() {
      nowPlaying.textContent = `Now Playing: ${sources[currentIndex].title}`;
      buildGuide();
    }

    // Build playlist guide list with highlight on current playing
    function buildGuide() {
      tvGuideList.innerHTML = '';
      sources.forEach((item, i) => {
        const li = document.createElement('li');
        li.textContent = item.title;
        if (i === currentIndex) li.classList.add('active');
        tvGuideList.appendChild(li);
      });
    }

    // Play next item in playlist loop
    function playNext() {
      currentIndex = (currentIndex + 1) % sources.length;
      playSegment(sources[currentIndex]);
    }

    // Play segment (YouTube or HLS)
    function playSegment(item) {
      updateNowPlaying();
      if (item.type === "youtube") {
        playYouTube(item.url);
      } else {
        playHLS(item.url);
      }
    }

    // Play HLS stream
    function playHLS(url) {
      if (ytPlayer) {
        ytPlayer.destroy();
        ytPlayer = null;
        ytContainer.innerHTML = '';
      }
      ytContainer.style.display = 'none';
      hlsPlayer.style.display = 'block';

      if (hlsPlayer.canPlayType("application/vnd.apple.mpegurl")) {
        hlsPlayer.src = url;
        hlsPlayer.muted = isMuted;
        hlsPlayer.play();
        hlsPlayer.onended = playNext;
      } else if (Hls.isSupported()) {
        if (window.hls) {
          window.hls.destroy();
        }
        window.hls = new Hls();
        window.hls.loadSource(url);
        window.hls.attachMedia(hlsPlayer);
        window.hls.on(Hls.Events.MANIFEST_PARSED, () => {
          hlsPlayer.muted = isMuted;
          hlsPlayer.play();
        });
        hlsPlayer.onended = playNext;
      }
    }

    // Extract videoId from YouTube URL
    function getYoutubeVideoId(url) {
      try {
        const urlObj = new URL(url);
        if (urlObj.searchParams.has('v')) return urlObj.searchParams.get('v');
        return urlObj.pathname.split('/').pop();
      } catch {
        return url;
      }
    }

    // Play YouTube video
    function playYouTube(url) {
      const videoId = getYoutubeVideoId(url);

      hlsPlayer.pause();
      hlsPlayer.style.display = 'none';
      ytContainer.style.display = 'block';

      if (ytPlayer) {
        ytPlayer.loadVideoById(videoId);
        if (isMuted) ytPlayer.mute();
        else ytPlayer.unMute();
        ytPlayer.playVideo();
        return;
      }

      ytPlayer = new YT.Player('ytPlayer', {
        height: '100%',
        width: '100%',
        videoId: videoId,
        playerVars: {
          autoplay: 1,
          controls: 0,
          modestbranding: 1,
          playsinline: 1,
          disablekb: 1,
          rel: 0,
          showinfo: 0,
          mute: 1,
        },
        events: {
          onReady: (event) => {
            if (!isMuted) event.target.unMute();
            event.target.playVideo();
          },
          onStateChange: (event) => {
            if (event.data === YT.PlayerState.ENDED) {
              playNext();
            }
          }
        }
      });
    }

    // Speaker toggle mute/unmute
    speakerBtn.addEventListener('click', () => {
      isMuted = !isMuted;
      updateMuteState();
    });

    function updateMuteState() {
      if (isMuted) {
        muteCross.style.display = "inline";
        speakerBtn.title = "Unmute";
        hlsPlayer.muted = true;
        if (ytPlayer) ytPlayer.mute();
      } else {
        muteCross.style.display = "none";
        speakerBtn.title = "Mute";
        hlsPlayer.muted = false;
        if (ytPlayer) ytPlayer.unMute();
      }
    }

    // Load YouTube API and start first video after ready
    function onYouTubeIframeAPIReady() {
      playSegment(sources[currentIndex]);
      updateMuteState();
    }

    window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;
  </script>

</body>
</html>
