<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Live TV Channel</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1a1a1a; /* Dark background */
            color: #f0f0f0; /* Light text */
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        .tv-container {
            width: 90%; /* Adjust as needed */
            max-width: 1280px; /* Max width for large screens, e.g., 720p or 1080p aspect */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            background-color: #2a2a2a;
        }

        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio (height / width * 100) */
            height: 0;
            overflow: hidden;
            background-color: black; /* Background for when video is loading */
        }

        #player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10; /* Place it above the video */
            pointer-events: auto; /* It will receive pointer events */
            /* background: rgba(255, 0, 0, 0.1); /* Uncomment for debugging to see the overlay */
        }

        /* Custom Unmute Button */
        .unmute-button {
            position: absolute;
            /* Positioning for top-right corner */
            top: 20px; /* Distance from the top */
            right: 20px; /* Distance from the right */ /* Changed from 'left' to 'right' */

            z-index: 20; /* Place it above the overlay */
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            padding: 15px; /* Adjust padding for better look */
            border-radius: 50%; /* Make it circular */
            cursor: pointer;
            font-size: 2.0em; /* Icon size */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease, opacity 0.3s ease;
            opacity: 1; /* Default visible state */
        }

        .unmute-button:hover {
            background: rgba(0, 0, 0, 0.8);
        }

        .unmute-button .mute-icon { display: none; }
        .unmute-button.muted .mute-icon { display: inline-block; }
        .unmute-button.muted .unmute-icon { display: none; }
        .unmute-button:not(.muted) .mute-icon { display: none; }
        .unmute-button:not(.muted) .unmute-icon { display: inline-block; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .tv-container {
                width: 95%;
            }

            .unmute-button {
                top: 10px; /* Adjust for smaller screens */
                right: 10px; /* Adjust for smaller screens */ /* Changed from 'left' to 'right' */
                padding: 10px;
                font-size: 1.5em;
            }
        }

        @media (max-width: 480px) {
            .tv-container {
                width: 100%;
                border-radius: 0;
            }
            .unmute-button {
                top: 5px;
                right: 5px; /* Changed from 'left' to 'right' */
                padding: 8px;
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>

    <div class="tv-container">
        <div class="video-container">
            <div id="player"></div>
            <div class="video-overlay"></div> <button id="unmuteButton" class="unmute-button muted">
                <span class="mute-icon">ðŸ”‡</span>
                <span class="unmute-icon">ðŸ”Š</span>
            </button>
        </div>
    </div>

    <script>
        // Define your YouTube playlist with video IDs
        // IMPORTANT: Replace 'VIDEO_ID_...' with your actual YouTube video IDs
        const youtubePlaylist = [
            'BBvod49uySQ', // Example: Rick Astley
            'MFLVmAE4cqg', // Example: Lofi Hip Hop Radio
            'CQXGMwLwGSE', // Example: Epic Nature Documentary
            'c-dkEZqCboQ', // Example: Cozy Fireplace Sounds
            'VIDEO_ID_5',
            // Add more video IDs here
        ];

        const LAST_PLAYED_KEY = 'lastPlayedVideo'; // Key for localStorage
        let currentVideoIndex = 0;
        let player; // Holds the YouTube player object
        let saveInterval; // To clear the interval on unload

        const unmuteButton = document.getElementById('unmuteButton');

        // This function creates an <iframe> (and YouTube player)
        // after the API code downloads.
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '390', // Default height (will be overridden by CSS)
                width: '640',  // Default width (will be overridden by CSS)
                videoId: youtubePlaylist[currentVideoIndex],
                playerVars: {
                    'autoplay': 1,      // Autoplay the video (will be muted due to browser policy)
                    'controls': 0,      // Hide all default controls (seek bar, timestamp, etc.)
                    'disablekb': 1,     // Disable keyboard controls
                    'autohide': 1,      // Hide controls when idle (though they are already hidden)
                    'modestbranding': 1, // Remove YouTube logo on control bar
                    'rel': 0,           // Do not show related videos at the end
                    'iv_load_policy': 3 // Do not show video annotations
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError // Add error handling
                }
            });
        }

        // The API will call this function when the video player is ready.
        function onPlayerReady(event) {
            // Attempt to load previous state from localStorage
            const lastPlayed = JSON.parse(localStorage.getItem(LAST_PLAYED_KEY));
            if (lastPlayed && youtubePlaylist[lastPlayed.index]) {
                currentVideoIndex = lastPlayed.index;
                // Load video by ID and start at the saved time
                player.loadVideoById(youtubePlaylist[currentVideoIndex], lastPlayed.time);
            } else {
                // If no saved state, start with the first video from the beginning
                event.target.playVideo();
            }

            // Mute the player initially to comply with autoplay policies
            player.mute();
            unmuteButton.classList.add('muted'); // Ensure button reflects muted state

            // Start periodically saving current time to localStorage
            saveInterval = setInterval(() => {
                if (player && player.getCurrentTime) {
                    localStorage.setItem(LAST_PLAYED_KEY, JSON.stringify({
                        index: currentVideoIndex,
                        time: player.getCurrentTime()
                    }));
                }
            }, 5000); // Save every 5 seconds
        }

        // The API calls this function when the player's state changes.
        function onPlayerStateChange(event) {
            // If the video has ended, play the next one in the playlist
            if (event.data === YT.PlayerState.ENDED) {
                currentVideoIndex++;
                if (currentVideoIndex >= youtubePlaylist.length) {
                    currentVideoIndex = 0; // Loop back to the beginning
                }
                player.loadVideoById(youtubePlaylist[currentVideoIndex]);
            }
        }

        // Handle player errors (e.g., video not found, private video)
        function onPlayerError(event) {
            console.error('YouTube Player Error:', event.data);
            // Attempt to skip to the next video
            currentVideoIndex++;
            if (currentVideoIndex >= youtubePlaylist.length) {
                currentVideoIndex = 0; // Loop back
            }
            player.loadVideoById(youtubePlaylist[currentVideoIndex]);
        }

        // Unmute button functionality
        unmuteButton.addEventListener('click', () => {
            if (player.isMuted()) {
                player.unMute();
                unmuteButton.classList.remove('muted');
            } else {
                player.mute();
                unmuteButton.classList.add('muted');
            }
        });

        // Load the IFrame Player API asynchronously.
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // Clear the save interval when the page is about to be unloaded
        window.addEventListener('beforeunload', () => {
            clearInterval(saveInterval);
        });
    </script>

</body>
</html>
