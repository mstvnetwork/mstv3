<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live TV Broadcast</title>
    <script src="https://cdn.jsdelivr.net/npm/video.js/dist/video.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/video.js/dist/video-js.min.css" rel="stylesheet" />
    <style>
        #video-player {
            width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <video id="video-player" class="video-js vjs-default-skin" controls preload="auto" data-setup="{}">
        <source id="video-source" src="" type="application/x-mpegURL">
        Your browser does not support HTML5 video.
    </video>

    <script>
        const videoPlayer = videojs('video-player');
        let currentIndex = 0;
        let playlist = [];
        const jsonUrl = 'path/to/your/playlist.json'; // Update with your JSON file URL

        function fetchPlaylist() {
            fetch(jsonUrl)
                .then(response => response.json())
                .then(data => {
                    playlist = data.urls; // Assuming your JSON has a structure like { "urls": ["url1", "url2", ...] }
                    loadVideo();
                })
                .catch(error => console.error('Error fetching playlist:', error));
        }

        function loadVideo() {
            if (playlist.length > 0) {
                const savedIndex = localStorage.getItem('currentIndex');
                currentIndex = savedIndex ? parseInt(savedIndex) : 0;
                videoPlayer.src(playlist[currentIndex]);
                videoPlayer.play();
                videoPlayer.on('ended', nextVideo);
            }
        }

        function nextVideo() {
            currentIndex = (currentIndex + 1) % playlist.length;
            localStorage.setItem('currentIndex', currentIndex);
            loadVideo();
        }

        window.addEventListener('beforeunload', () => {
            localStorage.setItem('currentIndex', currentIndex);
        });

        window.addEventListener('load', () => {
            fetchPlaylist();
        });
    </script>
</body>
</html>
